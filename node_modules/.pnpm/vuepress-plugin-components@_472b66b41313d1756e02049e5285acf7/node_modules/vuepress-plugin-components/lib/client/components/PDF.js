import{isDef as S,checkIsiPad as F,checkIsMobile as L,checkIsSafari as P,isLinkHttp as D,ensureEndingSlash as C,entries as y,useLocaleConfig as T}from"@vuepress/helper/client";import{useScrollLock as $}from"@vueuse/core";import{defineComponent as E,shallowRef as h,ref as I,h as d,watch as R,onMounted as U,onUnmounted as _}from"vue";import{CancelFullScreenIcon as k,EnterFullScreenIcon as z}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as N}from"vuepress/client";import{u as H}from"../useSize-C8GaR9if.js";import{g as M}from"../getLink-DBmDl_2w.js";const f=e=>{console.error(`[PDF]: ${e}`)},j=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},B=e=>e instanceof HTMLElement?e:e==="string"?document.querySelector(e):document.body,J=e=>{let o=y(e).map(([r,l])=>r==="noToolbar"?`toolbar=${l?"0":"1"}`:`${encodeURIComponent(r)}=${encodeURIComponent(l)}`).join("&");return o&&(o=`#${o.slice(0,o.length-1)}`),o},w=(e,o,r,l,i)=>{j(o);const u=`${e==="pdfjs"?`${C(N(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(r)}`:r}${J(l)}`,a=e==="pdfjs"||e==="iframe"?"iframe":"embed",n=document.createElement(a);return n.className="pdf-viewer",n.type="application/pdf",n.title=i,n.src=u,n instanceof HTMLIFrameElement&&(n.allow="fullscreen"),o.classList.add("pdf-viewer-container"),o.appendChild(n),o.getElementsByTagName(a)[0]},x=(e,o,{title:r,hint:l,options:i={},force:u})=>{if(typeof window>"u"||!window?.navigator?.userAgent)return null;const{navigator:a}=window,{userAgent:n}=a,c=S(window.Promise),t=F(n)||L(n),m=!t&&P(n),v=!t&&/firefox/iu.test(n)&&n.split("rv:").length>1?parseInt(n.split("rv:")[1].split(".")[0],10)>18:!1,b=!t&&(c||v),s=B(o);if(!s)return f("Target element cannot be determined"),null;const p=D(e)?e:__VUEPRESS_DEV__?null:`${window.origin}${e}`,g=r??/\/([^/]+).pdf/.exec(e)?.[1]??"PDF Viewer";return u?p?PDFJS_URL?w("pdfjs",s,e,i,g):(s.innerHTML=l.replace(/\[url\]/g,p),f("PDFJS URL is not defined"),null):(f("PDF link is not accessible."),null):b||!t?w(m?"iframe":"embed",s,e,i,g):PDFJS_URL&&p?w("pdfjs",s,e,i,g):(s.innerHTML=l.replace(/\[url\]/g,e),f("This browser does not support embedded PDFs"),null)};var A=E({name:"PDF",props:{url:{type:String,required:!0},title:String,width:{type:[String,Number],default:"100%"},height:[String,Number],ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:[String,Number],viewer:Boolean},setup(e){const{el:o,width:r,height:l,resize:i}=H(e),u=T(PDF_LOCALES),a=h(),n=h(),c=$(a),t=I(!1);return R(t,m=>{c.value=m}),U(()=>{a.value=document.body,x(M(e.url),n.value,{title:e.title,hint:u.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom&&e.zoom.toString()!=="100"?{zoom:e.zoom}:{}},force:e.viewer}),i()}),_(()=>{c.value=!1}),()=>d("div",{class:["pdf-viewer-wrapper",{fullscreen:t.value}],ref:o,style:t.value?{}:{width:r.value,height:l.value}},[d("div",{ref:n}),e.noFullscreen?null:d("button",{class:"pdf-fullscreen-button",onClick:()=>{t.value=!t.value}},d(t.value?k:z,{class:"pdf-fullscreen-icon"}))])}});export{A as default};
//# sourceMappingURL=PDF.js.map
